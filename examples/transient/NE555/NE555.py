# Copyright (C) 2006-2024 The ASysC project                        
#                                                                    
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or   
# any later version.                                                  
#                                                                    
# This program is distributed in the hope that it will be useful,     
# but WITHOUT ANY WARRANTY; without even the implied warranty of      
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the       
# GNU General Public License for more details.                        
#                                                                    
# You should have received a copy of the GNU General Public License   
# along with this program; If not, see <https://www.gnu.org/licenses/>

import math
import circuit_base
from circuit_base import circuit_base, element

class circuit( circuit_base ):

	def __init__(self):
		super().__init__()
		self.IC_VCC = element('IC_VCC')
		self.IC_SR_Iout = element('IC_SR_Iout')
		self.IC_SW_I = element('IC_SW_I')
		self.IC_IOUT = element('IC_IOUT')
		self.C1_I = element('C1_I')
		self.V1_I = element('V1_I')
		self.RA_I = element('RA_I')
		self.RB_I = element('RB_I')
		self.C1_U = element('C1_U')
		self.IC_UTRIG = element('IC_UTRIG')
		self.RB_U = element('RB_U')
		self.P2_U = element('P2_U')
		self.RA_U = element('RA_U')
		self.IC_SR_Uin1 = element('IC_SR_Uin1')
		self.IC_UIN1 = element('IC_UIN1')
		self.IC_SR_Uin2 = element('IC_SR_Uin2')
		self.IC_UIN2 = element('IC_UIN2')
		self.IC_SR_Uout = element('IC_SR_Uout')
		self.IC_UOUT2 = element('IC_UOUT2')
		self.IC_SW_U = element('IC_SW_U')
		self.IC_UOUT = element('IC_UOUT')
		self.P1_U = element('P1_U')
		self.IC_UTRESH = element('IC_UTRESH')
		self.V1_U = element('V1_U')

	def step(self):
		self._setc(self.IC_VCC,-((((self._last(self.IC_UOUT2)<0.5<=0.5)+((self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U)))-((self._last(self.IC_UOUT2)<0.5)>0.5)*2700+(self._last(self.IC_UOUT2)<0.5<=0.5)*(13000*(1e-06*self._der1(self.C1_U))))-((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U)))))*7.5)/(((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1)))))
		self._setc(self.IC_SR_Iout,0)
		self._setc(self.IC_SW_I,((((self._last(self.IC_UOUT2)<0.5)>0.5)+((self._last(self.IC_UOUT2)<0.5)>0.5)*(13000*(1e-06*self._der1(self.C1_U))))*7.5-(((self._last(self.IC_UOUT2)<0.5)>0.5)*2700)*(1e-06*self._der0(self.C1_U)))/((((self._last(self.IC_UOUT2)<0.5)>0.5)*2700+((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U)))))-(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1))*(self._last(self.IC_UOUT2)<0.5<=0.5)))
		self._setc(self.IC_IOUT,0)
		self._setc(self.C1_I,((((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5))*(1e-06*self._der0(self.C1_U))-((self._last(self.IC_UOUT2)<0.5<=0.5)*(1e-06*self._der1(self.C1_U))-((self._last(self.IC_UOUT2)<0.5)>0.5)*(13000*(1e-06*self._der1(self.C1_U)))+((self._last(self.IC_UOUT2)<0.5)>0.5)*(13000*(1e-06*self._der1(self.C1_U))))*7.5)/(((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+13000*(1e-06*self._der1(self.C1_U)))+((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5)))
		self._setc(self.V1_I,-(((((self._last(self.IC_UOUT2)<0.5<=0.5)*(1e-06*self._der1(self.C1_U))-((self._last(self.IC_UOUT2)<0.5)>0.5))-((self._last(self.IC_UOUT2)<0.5)>0.5)*(13000*(1e-06*self._der1(self.C1_U))))*7.5+(self._last(self.IC_UOUT2)<0.5<=0.5)*(1e-06*self._der0(self.C1_U)))/((self._last(self.IC_UOUT2)<0.5<=0.5)+((self._last(self.IC_UOUT2)<0.5<=0.5)*(13000*(1e-06*self._der1(self.C1_U)))-(((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U)))))-((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U)))))))
		self._setc(self.RA_I,((((self._last(self.IC_UOUT2)<0.5<=0.5)*(1e-06*self._der1(self.C1_U))-((self._last(self.IC_UOUT2)<0.5)>0.5))-((self._last(self.IC_UOUT2)<0.5)>0.5)*(13000*(1e-06*self._der1(self.C1_U))))*7.5+(self._last(self.IC_UOUT2)<0.5<=0.5)*(1e-06*self._der0(self.C1_U)))/(((self._last(self.IC_UOUT2)<0.5<=0.5)*(13000*(1e-06*self._der1(self.C1_U)))+(self._last(self.IC_UOUT2)<0.5<=0.5))+(((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5)-13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5)))-((self._last(self.IC_UOUT2)<0.5)>0.5))*2700))
		self._setc(self.RB_I,(((self._last(self.IC_UOUT2)<0.5<=0.5)-((self._last(self.IC_UOUT2)<0.5)>0.5)*2700)*(1e-06*self._der0(self.C1_U))-((((self._last(self.IC_UOUT2)<0.5)>0.5)-(self._last(self.IC_UOUT2)<0.5<=0.5)*(1e-06*self._der1(self.C1_U)))-((self._last(self.IC_UOUT2)<0.5)>0.5))*7.5)/(((self._last(self.IC_UOUT2)<0.5<=0.5)-((self._last(self.IC_UOUT2)<0.5)>0.5)*2700+(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))))-((1e-06*self._der1(self.C1_U))*(((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5)))*13000))
		self._setc(self.C1_U,(((self._last(self.IC_UOUT2)<0.5<=0.5)-((self._last(self.IC_UOUT2)<0.5)>0.5)*13000+((self._last(self.IC_UOUT2)<0.5)>0.5)*13000)*7.5-(((self._last(self.IC_UOUT2)<0.5<=0.5)*2700+(self._last(self.IC_UOUT2)<0.5<=0.5)*13000)-((self._last(self.IC_UOUT2)<0.5)>0.5)*35100000)*(1e-06*self._der0(self.C1_U)))/((((self._last(self.IC_UOUT2)<0.5<=0.5)*2700+(self._last(self.IC_UOUT2)<0.5<=0.5)*13000)-((self._last(self.IC_UOUT2)<0.5)>0.5)*35100000)*(1e-06*self._der1(self.C1_U))+(self._last(self.IC_UOUT2)<0.5<=0.5)-((self._last(self.IC_UOUT2)<0.5)>0.5)*2700))
		self._setc(self.IC_UTRIG,((((self._last(self.IC_UOUT2)<0.5)>0.5)*35100000-((self._last(self.IC_UOUT2)<0.5<=0.5)*2700+(self._last(self.IC_UOUT2)<0.5<=0.5)*13000))*(1e-06*self._der0(self.C1_U))-((((self._last(self.IC_UOUT2)<0.5)>0.5)*13000-(self._last(self.IC_UOUT2)<0.5<=0.5))-((self._last(self.IC_UOUT2)<0.5)>0.5)*13000)*7.5)/((1e-06*self._der1(self.C1_U))*(((self._last(self.IC_UOUT2)<0.5<=0.5)*2700+(self._last(self.IC_UOUT2)<0.5<=0.5)*13000)-((self._last(self.IC_UOUT2)<0.5)>0.5)*35100000)-(((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5))))
		self._setc(self.RB_U,((((self._last(self.IC_UOUT2)<0.5)>0.5)*35100000-(self._last(self.IC_UOUT2)<0.5<=0.5)*13000)*(1e-06*self._der0(self.C1_U))-(((self._last(self.IC_UOUT2)<0.5)>0.5)*13000+(self._last(self.IC_UOUT2)<0.5<=0.5)*(13000*(1e-06*self._der1(self.C1_U)))-((self._last(self.IC_UOUT2)<0.5)>0.5)*13000)*7.5)/(13000*((1e-06*self._der1(self.C1_U))*(((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5)))-((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5<=0.5)*2700)-(((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5)))))
		self._setc(self.P2_U,(((self._last(self.IC_UOUT2)<0.5<=0.5)+(self._last(self.IC_UOUT2)<0.5<=0.5)*(13000*(1e-06*self._der1(self.C1_U))))*7.5-((self._last(self.IC_UOUT2)<0.5<=0.5)*2700)*(1e-06*self._der0(self.C1_U)))/(((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5<=0.5)*2700)+(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5)))-2700*(13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5))+((self._last(self.IC_UOUT2)<0.5)>0.5))))
		self._setc(self.RA_U,((((self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U)))-((self._last(self.IC_UOUT2)<0.5)>0.5)*2700)-((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U)))))*7.5+((self._last(self.IC_UOUT2)<0.5<=0.5)*2700)*(1e-06*self._der0(self.C1_U)))/((13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5))+2700*(((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5)-13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5)))-((self._last(self.IC_UOUT2)<0.5)>0.5))))
		self._setc(self.IC_SR_Uin1,(((self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1))-((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1)))*(self._last(self.IC_UTRIG)<self._last(self.IC_VCC)/3))/((13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5))-2700*(13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5))-(1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5)+((self._last(self.IC_UOUT2)<0.5)>0.5))))
		self._setc(self.IC_UIN1,((((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1)))*(self._last(self.IC_UTRIG)<self._last(self.IC_VCC)/3))/(((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1))))
		self._setc(self.IC_SR_Uin2,-(((((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1)))*(self._last(self.IC_UTRESH)<self._last(self.IC_VCC)*0.666666666667))/(2700*(((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5)-13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5)))-((self._last(self.IC_UOUT2)<0.5)>0.5))+(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5)))))
		self._setc(self.IC_UIN2,-((((self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1))-((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1)))*(self._last(self.IC_UTRESH)<self._last(self.IC_VCC)*0.666666666667))/(((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1)))))
		self._setc(self.IC_SR_Uout,((2700*(((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5)-13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5)))-((self._last(self.IC_UOUT2)<0.5)>0.5))+(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5)))*(((self._last(self.IC_SR_Uout)>0.5)|(self._last(self.IC_SR_Uin1)>0.5))&(self._last(self.IC_SR_Uin2)>0.5)))/(2700*(((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5)-13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5)))-((self._last(self.IC_UOUT2)<0.5)>0.5))+(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5))))
		self._setc(self.IC_UOUT2,-(((2700*(((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5)-13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5)))-((self._last(self.IC_UOUT2)<0.5)>0.5))+(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5)))*(((self._last(self.IC_SR_Uout)>0.5)|(self._last(self.IC_SR_Uin1)>0.5))&(self._last(self.IC_SR_Uin2)>0.5)))/(2700*(13000*((1e-06*self._der1(self.C1_U))*((self._last(self.IC_UOUT2)<0.5)>0.5))-(1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5)+((self._last(self.IC_UOUT2)<0.5)>0.5))-(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5)))))
		self._setc(self.IC_SW_U,(((self._last(self.IC_UOUT2)<0.5<=0.5)+(self._last(self.IC_UOUT2)<0.5<=0.5)*(13000*(1e-06*self._der1(self.C1_U))))*7.5-((self._last(self.IC_UOUT2)<0.5<=0.5)*2700)*(1e-06*self._der0(self.C1_U)))/((2700*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_UOUT2)<0.5<=0.5))+(self._last(self.IC_UOUT2)<0.5<=0.5)))-(2700*(13000*(1e-06*self._der1(self.C1_U))+1))*((self._last(self.IC_UOUT2)<0.5)>0.5)))
		self._setc(self.IC_UOUT,-(((2700*(((1e-06*self._der1(self.C1_U))*(self._last(self.IC_VCC)*(self._last(self.IC_UOUT2)<0.5<=0.5))-13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_VCC)*((self._last(self.IC_UOUT2)<0.5)>0.5))))-self._last(self.IC_VCC)*((self._last(self.IC_UOUT2)<0.5)>0.5))+(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_VCC)*(self._last(self.IC_UOUT2)<0.5<=0.5)))+self._last(self.IC_VCC)*(self._last(self.IC_UOUT2)<0.5<=0.5)))*(((self._last(self.IC_SR_Uout)>0.5)|(self._last(self.IC_SR_Uin1)>0.5))&(self._last(self.IC_SR_Uin2)>0.5)))/(((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1)))))
		self._setc(self.P1_U,-(((2700*(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_VCC)*((self._last(self.IC_UOUT2)<0.5)>0.5)))-(1e-06*self._der1(self.C1_U))*(self._last(self.IC_VCC)*(self._last(self.IC_UOUT2)<0.5<=0.5))+self._last(self.IC_VCC)*((self._last(self.IC_UOUT2)<0.5)>0.5))-(13000*((1e-06*self._der1(self.C1_U))*(self._last(self.IC_VCC)*(self._last(self.IC_UOUT2)<0.5<=0.5)))+self._last(self.IC_VCC)*(self._last(self.IC_UOUT2)<0.5<=0.5)))*(((self._last(self.IC_SR_Uout)>0.5)|(self._last(self.IC_SR_Uin1)>0.5))&(self._last(self.IC_SR_Uin2)>0.5)))/((self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1))-((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1)))))
		self._setc(self.IC_UTRESH,((((self._last(self.IC_UOUT2)<0.5<=0.5)*2700+(self._last(self.IC_UOUT2)<0.5<=0.5)*13000)-((self._last(self.IC_UOUT2)<0.5)>0.5)*35100000)*(1e-06*self._der0(self.C1_U))-((self._last(self.IC_UOUT2)<0.5<=0.5)-((self._last(self.IC_UOUT2)<0.5)>0.5)*13000+((self._last(self.IC_UOUT2)<0.5)>0.5)*13000)*7.5)/(((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))+1))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))+(13000*(1e-06*self._der1(self.C1_U))+1))))
		self._setc(self.V1_U,-(((((((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(13000*(1e-06*self._der1(self.C1_U)))+((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U)))))-(self._last(self.IC_UOUT2)<0.5<=0.5))*7.5)/((self._last(self.IC_UOUT2)<0.5<=0.5)-((((self._last(self.IC_UOUT2)<0.5)>0.5)*2700-(self._last(self.IC_UOUT2)<0.5<=0.5)*(2700*(1e-06*self._der1(self.C1_U))))-(self._last(self.IC_UOUT2)<0.5<=0.5)*(13000*(1e-06*self._der1(self.C1_U)))+((self._last(self.IC_UOUT2)<0.5)>0.5)*(2700*(13000*(1e-06*self._der1(self.C1_U))))))))

